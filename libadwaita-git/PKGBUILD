# https://aur.archlinux.org/packages/libadwaita-git
groups=('modified')

pkgname=libadwaita-git
pkgver=1.1.0.r1596.g65ac525
pkgrel=1
pkgdesc="Library full of GTK+ widgets for mobile phones"
url="https://gitlab.gnome.org/GNOME/libadwaita"
license=('LGPL')
arch=('i686' 'x86_64' 'armv7h' 'aarch64')
depends=('gtk4')
makedepends=('git' 'gobject-introspection' 'meson' 'sassc' 'vala' 'wayland-protocols')
provides=("${pkgname%-git}" 'libadwaita-1.so')
conflicts=("${pkgname%-git}")
source=('git+https://gitlab.gnome.org/GNOME/libadwaita.git')
sha256sums=('SKIP')

pkgver() {
    cd "$srcdir/${pkgname%-git}"
    printf "%s.r%s.g%s" "$(grep -m1 'version' meson.build | sed -r 's/([^0-9]*([0-9.]+)).*/\2/')" \
        "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
  }

build() {
    arch-meson "${pkgname%-git}" build \
        -Dgtk_doc=true \
        -Dexamples=false
    meson compile -C build
}

package() {
    DESTDIR="$pkgdir" meson install -C build
}
